<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Arcade Slot â€” ã‚µãƒ³ãƒ—ãƒ«</title>
  <style>
    :root{
      --bg:#0f1724; --panel:#0b1220; --accent:#ffd166; --muted:#94a3b8;
    }
    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Yu Gothic", sans-serif;
      background: linear-gradient(180deg,#07102a,#0b1220);
      color:#e6eef8;
      display:flex; align-items:center; justify-content:center; min-height:100vh; margin:0;
    }
    .machine{
      width:760px; max-width:95vw; background:linear-gradient(180deg,#071428,#08223d);
      padding:20px; border-radius:16px; box-shadow:0 10px 40px rgba(2,6,23,0.8);
      display:grid; grid-template-columns: 1fr 250px; gap:18px;
    }

    /* Left: reels */
    .left{ background:var(--panel); padding:16px; border-radius:12px; }
    .reels{ display:flex; gap:12px; justify-content:center; align-items:center; }
    .reel{
      width:160px; height:160px; background:linear-gradient(180deg,#0f1b2a,#071022);
      border-radius:8px; display:flex; flex-direction:column; justify-content:center; align-items:center;
      font-size:48px; letter-spacing:2px; color:#fff; box-shadow: inset 0 -6px 20px rgba(0,0,0,0.6);
      position:relative; overflow:hidden;
    }
    .sym{ font-size:44px; text-align:center; transform:translateY(0); transition:transform .45s cubic-bezier(.2,.8,.2,1); }
    .reel.spin .sym{ transform:translateY(-50%); opacity:0.3; }

    .controls{ display:flex; align-items:center; justify-content:space-between; margin-top:14px; gap:12px; }
    button{ background:var(--accent); color:#0b1220; border:none; padding:10px 18px; border-radius:8px; font-weight:700; cursor:pointer; box-shadow: 0 6px 18px rgba(255,209,102,0.12); }
    button:disabled{ opacity:0.5; cursor:default; }

    .info{ color:var(--muted); font-size:13px; }

    /* Right: panel */
    .right{ background:linear-gradient(180deg,#071022,#071b2a); padding:16px; border-radius:12px; display:flex; flex-direction:column; gap:12px; align-items:stretch; }
    .lamp{
      width:72px; height:72px; border-radius:50%; background:#21324a; margin-left:auto; box-shadow: inset 0 -8px 20px rgba(0,0,0,0.6);
      display:flex; align-items:center; justify-content:center; color:#a8c7e8; font-weight:800;
    }
    .lamp.on{ background:linear-gradient(180deg,#ffd166,#ff8a00); color:#2b1200; box-shadow:0 6px 30px rgba(255,138,0,0.25); }

    .stat{ display:flex; flex-direction:column; gap:6px; }
    .stat div{ display:flex; justify-content:space-between; color:var(--muted); font-size:14px; }
    .log{ background:rgba(255,255,255,0.02); padding:8px; border-radius:8px; max-height:160px; overflow:auto; font-size:13px; color:#dfeffb; }

    footer.small{ font-size:12px; color:var(--muted); margin-top:6px; text-align:center; }
  </style>
</head>
<body>
  <div class="machine" role="application" aria-label="Arcade Slot demo">
    <div class="left">
      <div style="display:flex;align-items:center;justify-content:space-between;">
        <div>
          <h2 style="margin:0 0 6px 0">Arcade Slotï¼ˆãƒ‡ãƒ¢ï¼‰</h2>
          <div class="info">å­¦ç¿’ç”¨ã‚µãƒ³ãƒ—ãƒ« â€” å®Ÿåœ¨ã®éŠæŠ€æ©Ÿã¨ã¯åˆ¥ç‰©ã§ã™</div>
        </div>
        <div id="bonusLamp" class="lamp" aria-live="polite" title="Bonus lamp">LAMP</div>
      </div>

      <div class="reels" aria-hidden="false" style="margin-top:14px;">
        <div class="reel" id="reel0"><div class="sym" id="sym0">ğŸ’</div></div>
        <div class="reel" id="reel1"><div class="sym" id="sym1">ğŸ‹</div></div>
        <div class="reel" id="reel2"><div class="sym" id="sym2">ğŸ””</div></div>
      </div>

      <div class="controls">
        <div style="display:flex;gap:8px;align-items:center;">
          <button id="spinBtn">SPIN</button>
          <div class="info">Points: <span id="points">1000</span></div>
        </div>
        <div class="info">Bet: <span id="bet">1</span></div>
      </div>

      <div style="margin-top:10px">
        <div class="info">èª¬æ˜ï¼šã‚·ãƒ³ãƒœãƒ«ã®å‡ºç¾ã¯é‡ã¿ï¼ˆç›¸å¯¾ç¢ºç‡ï¼‰ã§æ±ºå®šã•ã‚Œã¾ã™ã€‚ãƒœãƒ¼ãƒŠã‚¹ãƒ©ãƒ³ãƒ—ã¯ç‹¬ç«‹ã—ãŸç¢ºç‡ã§å…‰ã‚Šã¾ã™ã€‚</div>
      </div>
    </div>

    <div class="right">
      <div class="stat">
        <div><strong>Symbol weights</strong><span id="weightsSummary"></span></div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;">
          <!-- weight controls will be injected -->
          <div style="flex:1 1 100%">
            <label class="info">ãƒœãƒ¼ãƒŠã‚¹ãƒ©ãƒ³ãƒ—ç¢ºç‡ï¼ˆ0ã€œ1ï¼‰ï¼š <input id="bonusChance" type="number" step="0.01" min="0" max="1" value="0.10" style="width:64px"></label>
          </div>
        </div>
      </div>

      <div>
        <div><strong>Last result</strong></div>
        <div class="log" id="log" aria-live="polite"></div>
      </div>

      <div style="margin-top:auto;">
        <div class="info">ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã¯æ•™è‚²ç”¨é€”ã§ã™ã€‚å®Ÿæ©Ÿã®å½¹ãƒ»ç¢ºç‡ã¯å†ç¾ã—ã¾ã›ã‚“ã€‚</div>
      </div>
    </div>
  </div>

<script>
/*
  Arcade Slot â€” ãƒ‡ãƒ¢å®Ÿè£…
  ãƒ»symbolWeights: ã‚·ãƒ³ãƒœãƒ«æ¯ã®ã€Œé‡ã¿ã€ã€‚é‡ã¿ã®æ¯”ãŒãã®ã‚·ãƒ³ãƒœãƒ«ã®ç›¸å¯¾çš„å‡ºç¾ç¢ºç‡ã«ãªã‚Šã¾ã™ã€‚
  ãƒ»bonusChance: ã‚¹ãƒ”ãƒ³1å›ã”ã¨ã®ç‹¬ç«‹ã—ãŸã€Œãƒœãƒ¼ãƒŠã‚¹ãƒ©ãƒ³ãƒ—ç‚¹ç¯ç¢ºç‡ã€ã€‚0ã€œ1ã§è¨­å®šã€‚
  ãƒ»å½“ãŸã‚Šåˆ¤å®šã¯ç°¡ç´ åŒ–ï¼ˆ3ã¤æƒã„ï¼å¤§å½“ãŸã‚Šã€2ã¤ï¼å°å½“ãŸã‚Šï¼‰ã€‚
  â€» å®Ÿæ©Ÿã®æ•°å€¤ã‚„åç§°ã¯å«ã‚ãªã„ã§ãã ã•ã„ï¼ˆå­¦ç¿’ç”¨ï¼‰ã€‚
*/

const symbols = [
  { id:'cherry', icon:'ğŸ’', weight:30 },
  { id:'lemon',  icon:'ğŸ‹', weight:25 },
  { id:'bell',   icon:'ğŸ””', weight:20 },
  { id:'bar',    icon:'ğŸ”²', weight:15 },
  { id:'seven',  icon:'7ï¸âƒ£', weight:10 },
];

let points = 1000;

// HTML elements
const spinBtn = document.getElementById('spinBtn');
const pointsEl = document.getElementById('points');
const logEl = document.getElementById('log');
const bonusLamp = document.getElementById('bonusLamp');
const bonusInput = document.getElementById('bonusChance');
const weightsSummary = document.getElementById('weightsSummary');

// initialize weight controls & summary
function updateWeightsSummary(){
  const s = symbols.map(s=> `${s.icon}:${s.weight}`).join(' ');
  weightsSummary.textContent = s;
}
updateWeightsSummary();

// Weighted random selection function
function weightedRandom(items){
  // items: [{weight: number, ...}, ...]
  const total = items.reduce((a,b)=>a + (b.weight||0), 0);
  if(total <= 0) return items[0];
  let r = Math.random() * total;
  for(let it of items){
    r -= (it.weight||0);
    if(r < 0) return it;
  }
  return items[items.length-1];
}

// Evaluate spin result (simple rules)
function evaluateResult(centerSymbols){
  // centerSymbols: array of 3 symbol objects
  const ids = centerSymbols.map(s=>s.id);
  const unique = [...new Set(ids)];
  if(unique.length === 1){
    // three of a kind
    return { type:'BIG', payout: 200 };
  } else if(unique.length === 2){
    // two of a kind
    return { type:'SMALL', payout: 20 };
  } else {
    return { type:'MISS', payout: 0 };
  }
}

// Append to log
function appendLog(text){
  const el = document.createElement('div');
  const now = new Date();
  el.textContent = `[${now.toLocaleTimeString()}] ${text}`;
  logEl.prepend(el);
  // keep log reasonable
  while(logE
